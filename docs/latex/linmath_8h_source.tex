\hypertarget{linmath_8h_source}{}\doxysection{linmath.\+h}
\label{linmath_8h_source}\index{/Users/pvelesko/local/CHIP-\/SPV/HIP/samples/2\_Cookbook/20\_hip\_vulkan/linmath.h@{/Users/pvelesko/local/CHIP-\/SPV/HIP/samples/2\_Cookbook/20\_hip\_vulkan/linmath.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright (c) 2015-\/2016 The Khronos Group Inc.}}
\DoxyCodeLine{3 \textcolor{comment}{ * Copyright (c) 2015-\/2016 Valve Corporation}}
\DoxyCodeLine{4 \textcolor{comment}{ * Copyright (c) 2015-\/2016 LunarG, Inc.}}
\DoxyCodeLine{5 \textcolor{comment}{ *}}
\DoxyCodeLine{6 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{7 \textcolor{comment}{ * you may not use this file except in compliance with the License.}}
\DoxyCodeLine{8 \textcolor{comment}{ * You may obtain a copy of the License at}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ *     http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{11 \textcolor{comment}{ *}}
\DoxyCodeLine{12 \textcolor{comment}{ * Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{13 \textcolor{comment}{ * distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{14 \textcolor{comment}{ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{15 \textcolor{comment}{ * See the License for the specific language governing permissions and}}
\DoxyCodeLine{16 \textcolor{comment}{ * limitations under the License.}}
\DoxyCodeLine{17 \textcolor{comment}{ *}}
\DoxyCodeLine{18 \textcolor{comment}{ * Relicensed from the WTFPL (http://www.wtfpl.net/faq/).}}
\DoxyCodeLine{19 \textcolor{comment}{ */}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#ifndef LINMATH\_H}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#define LINMATH\_H}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{preprocessor}{\#define \_USE\_MATH\_DEFINES}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <math.h>}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{comment}{// Converts degrees to radians.}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#define degreesToRadians(angleDegrees) (angleDegrees * M\_PI / 180.0)}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{comment}{// Converts radians to degrees.}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#define radiansToDegrees(angleRadians) (angleRadians * 180.0 / M\_PI)}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{keyword}{typedef} \textcolor{keywordtype}{float} vec3[3];}
\DoxyCodeLine{34 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vec3\_add(vec3 r, vec3 \textcolor{keyword}{const} a, vec3 \textcolor{keyword}{const} b) \{}
\DoxyCodeLine{35     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{36     \textcolor{keywordflow}{for} (i = 0; i < 3; ++i) r[i] = a[i] + b[i];}
\DoxyCodeLine{37 \}}
\DoxyCodeLine{38 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vec3\_sub(vec3 r, vec3 \textcolor{keyword}{const} a, vec3 \textcolor{keyword}{const} b) \{}
\DoxyCodeLine{39     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{40     \textcolor{keywordflow}{for} (i = 0; i < 3; ++i) r[i] = a[i] -\/ b[i];}
\DoxyCodeLine{41 \}}
\DoxyCodeLine{42 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vec3\_scale(vec3 r, vec3 \textcolor{keyword}{const} v, \textcolor{keywordtype}{float} \textcolor{keyword}{const} s) \{}
\DoxyCodeLine{43     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{44     \textcolor{keywordflow}{for} (i = 0; i < 3; ++i) r[i] = v[i] * s;}
\DoxyCodeLine{45 \}}
\DoxyCodeLine{46 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{float} vec3\_mul\_inner(vec3 \textcolor{keyword}{const} a, vec3 \textcolor{keyword}{const} b) \{}
\DoxyCodeLine{47     \textcolor{keywordtype}{float} p = 0.f;}
\DoxyCodeLine{48     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{49     \textcolor{keywordflow}{for} (i = 0; i < 3; ++i) p += b[i] * a[i];}
\DoxyCodeLine{50     \textcolor{keywordflow}{return} p;}
\DoxyCodeLine{51 \}}
\DoxyCodeLine{52 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vec3\_mul\_cross(vec3 r, vec3 \textcolor{keyword}{const} a, vec3 \textcolor{keyword}{const} b) \{}
\DoxyCodeLine{53     r[0] = a[1] * b[2] -\/ a[2] * b[1];}
\DoxyCodeLine{54     r[1] = a[2] * b[0] -\/ a[0] * b[2];}
\DoxyCodeLine{55     r[2] = a[0] * b[1] -\/ a[1] * b[0];}
\DoxyCodeLine{56 \}}
\DoxyCodeLine{57 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{float} vec3\_len(vec3 \textcolor{keyword}{const} v) \{ \textcolor{keywordflow}{return} sqrtf(vec3\_mul\_inner(v, v)); \}}
\DoxyCodeLine{58 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vec3\_norm(vec3 r, vec3 \textcolor{keyword}{const} v) \{}
\DoxyCodeLine{59     \textcolor{keywordtype}{float} k = 1.f / vec3\_len(v);}
\DoxyCodeLine{60     vec3\_scale(r, v, k);}
\DoxyCodeLine{61 \}}
\DoxyCodeLine{62 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vec3\_reflect(vec3 r, vec3 \textcolor{keyword}{const} v, vec3 \textcolor{keyword}{const} n) \{}
\DoxyCodeLine{63     \textcolor{keywordtype}{float} p = 2.f * vec3\_mul\_inner(v, n);}
\DoxyCodeLine{64     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{65     \textcolor{keywordflow}{for} (i = 0; i < 3; ++i) r[i] = v[i] -\/ p * n[i];}
\DoxyCodeLine{66 \}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68 \textcolor{keyword}{typedef} \textcolor{keywordtype}{float} vec4[4];}
\DoxyCodeLine{69 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vec4\_add(vec4 r, vec4 \textcolor{keyword}{const} a, vec4 \textcolor{keyword}{const} b) \{}
\DoxyCodeLine{70     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{71     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) r[i] = a[i] + b[i];}
\DoxyCodeLine{72 \}}
\DoxyCodeLine{73 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vec4\_sub(vec4 r, vec4 \textcolor{keyword}{const} a, vec4 \textcolor{keyword}{const} b) \{}
\DoxyCodeLine{74     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{75     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) r[i] = a[i] -\/ b[i];}
\DoxyCodeLine{76 \}}
\DoxyCodeLine{77 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vec4\_scale(vec4 r, vec4 v, \textcolor{keywordtype}{float} s) \{}
\DoxyCodeLine{78     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{79     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) r[i] = v[i] * s;}
\DoxyCodeLine{80 \}}
\DoxyCodeLine{81 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{float} vec4\_mul\_inner(vec4 a, vec4 b) \{}
\DoxyCodeLine{82     \textcolor{keywordtype}{float} p = 0.f;}
\DoxyCodeLine{83     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{84     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) p += b[i] * a[i];}
\DoxyCodeLine{85     \textcolor{keywordflow}{return} p;}
\DoxyCodeLine{86 \}}
\DoxyCodeLine{87 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vec4\_mul\_cross(vec4 r, vec4 a, vec4 b) \{}
\DoxyCodeLine{88     r[0] = a[1] * b[2] -\/ a[2] * b[1];}
\DoxyCodeLine{89     r[1] = a[2] * b[0] -\/ a[0] * b[2];}
\DoxyCodeLine{90     r[2] = a[0] * b[1] -\/ a[1] * b[0];}
\DoxyCodeLine{91     r[3] = 1.f;}
\DoxyCodeLine{92 \}}
\DoxyCodeLine{93 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{float} vec4\_len(vec4 v) \{ \textcolor{keywordflow}{return} sqrtf(vec4\_mul\_inner(v, v)); \}}
\DoxyCodeLine{94 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vec4\_norm(vec4 r, vec4 v) \{}
\DoxyCodeLine{95     \textcolor{keywordtype}{float} k = 1.f / vec4\_len(v);}
\DoxyCodeLine{96     vec4\_scale(r, v, k);}
\DoxyCodeLine{97 \}}
\DoxyCodeLine{98 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vec4\_reflect(vec4 r, vec4 v, vec4 n) \{}
\DoxyCodeLine{99     \textcolor{keywordtype}{float} p = 2.f * vec4\_mul\_inner(v, n);}
\DoxyCodeLine{100     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{101     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) r[i] = v[i] -\/ p * n[i];}
\DoxyCodeLine{102 \}}
\DoxyCodeLine{103 }
\DoxyCodeLine{104 \textcolor{keyword}{typedef} vec4 mat4x4[4];}
\DoxyCodeLine{105 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_identity(mat4x4 M) \{}
\DoxyCodeLine{106     \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{107     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i)}
\DoxyCodeLine{108         \textcolor{keywordflow}{for} (j = 0; j < 4; ++j) M[i][j] = i == j ? 1.f : 0.f;}
\DoxyCodeLine{109 \}}
\DoxyCodeLine{110 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_dup(mat4x4 M, mat4x4 N) \{}
\DoxyCodeLine{111     \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{112     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i)}
\DoxyCodeLine{113         \textcolor{keywordflow}{for} (j = 0; j < 4; ++j) M[i][j] = N[i][j];}
\DoxyCodeLine{114 \}}
\DoxyCodeLine{115 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_row(vec4 r, mat4x4 M, \textcolor{keywordtype}{int} i) \{}
\DoxyCodeLine{116     \textcolor{keywordtype}{int} k;}
\DoxyCodeLine{117     \textcolor{keywordflow}{for} (k = 0; k < 4; ++k) r[k] = M[k][i];}
\DoxyCodeLine{118 \}}
\DoxyCodeLine{119 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_col(vec4 r, mat4x4 M, \textcolor{keywordtype}{int} i) \{}
\DoxyCodeLine{120     \textcolor{keywordtype}{int} k;}
\DoxyCodeLine{121     \textcolor{keywordflow}{for} (k = 0; k < 4; ++k) r[k] = M[i][k];}
\DoxyCodeLine{122 \}}
\DoxyCodeLine{123 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_transpose(mat4x4 M, mat4x4 N) \{}
\DoxyCodeLine{124     \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{125     \textcolor{keywordflow}{for} (j = 0; j < 4; ++j)}
\DoxyCodeLine{126         \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) M[i][j] = N[j][i];}
\DoxyCodeLine{127 \}}
\DoxyCodeLine{128 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_add(mat4x4 M, mat4x4 a, mat4x4 b) \{}
\DoxyCodeLine{129     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{130     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) vec4\_add(M[i], a[i], b[i]);}
\DoxyCodeLine{131 \}}
\DoxyCodeLine{132 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_sub(mat4x4 M, mat4x4 a, mat4x4 b) \{}
\DoxyCodeLine{133     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{134     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) vec4\_sub(M[i], a[i], b[i]);}
\DoxyCodeLine{135 \}}
\DoxyCodeLine{136 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_scale(mat4x4 M, mat4x4 a, \textcolor{keywordtype}{float} k) \{}
\DoxyCodeLine{137     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{138     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) vec4\_scale(M[i], a[i], k);}
\DoxyCodeLine{139 \}}
\DoxyCodeLine{140 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_scale\_aniso(mat4x4 M, mat4x4 a, \textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} y, \textcolor{keywordtype}{float} z) \{}
\DoxyCodeLine{141     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{142     vec4\_scale(M[0], a[0], x);}
\DoxyCodeLine{143     vec4\_scale(M[1], a[1], y);}
\DoxyCodeLine{144     vec4\_scale(M[2], a[2], z);}
\DoxyCodeLine{145     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) \{}
\DoxyCodeLine{146         M[3][i] = a[3][i];}
\DoxyCodeLine{147     \}}
\DoxyCodeLine{148 \}}
\DoxyCodeLine{149 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_mul(mat4x4 M, mat4x4 a, mat4x4 b) \{}
\DoxyCodeLine{150     \textcolor{keywordtype}{int} k, r, c;}
\DoxyCodeLine{151     \textcolor{keywordflow}{for} (c = 0; c < 4; ++c)}
\DoxyCodeLine{152         \textcolor{keywordflow}{for} (r = 0; r < 4; ++r) \{}
\DoxyCodeLine{153             M[c][r] = 0.f;}
\DoxyCodeLine{154             \textcolor{keywordflow}{for} (k = 0; k < 4; ++k) M[c][r] += a[k][r] * b[c][k];}
\DoxyCodeLine{155         \}}
\DoxyCodeLine{156 \}}
\DoxyCodeLine{157 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_mul\_vec4(vec4 r, mat4x4 M, vec4 v) \{}
\DoxyCodeLine{158     \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{159     \textcolor{keywordflow}{for} (j = 0; j < 4; ++j) \{}
\DoxyCodeLine{160         r[j] = 0.f;}
\DoxyCodeLine{161         \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) r[j] += M[i][j] * v[i];}
\DoxyCodeLine{162     \}}
\DoxyCodeLine{163 \}}
\DoxyCodeLine{164 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_translate(mat4x4 T, \textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} y, \textcolor{keywordtype}{float} z) \{}
\DoxyCodeLine{165     mat4x4\_identity(T);}
\DoxyCodeLine{166     T[3][0] = x;}
\DoxyCodeLine{167     T[3][1] = y;}
\DoxyCodeLine{168     T[3][2] = z;}
\DoxyCodeLine{169 \}}
\DoxyCodeLine{170 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_translate\_in\_place(mat4x4 M, \textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} y, \textcolor{keywordtype}{float} z) \{}
\DoxyCodeLine{171     vec4 t = \{x, y, z, 0\};}
\DoxyCodeLine{172     vec4 r;}
\DoxyCodeLine{173     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{174     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) \{}
\DoxyCodeLine{175         mat4x4\_row(r, M, i);}
\DoxyCodeLine{176         M[3][i] += vec4\_mul\_inner(r, t);}
\DoxyCodeLine{177     \}}
\DoxyCodeLine{178 \}}
\DoxyCodeLine{179 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_from\_vec3\_mul\_outer(mat4x4 M, vec3 a, vec3 b) \{}
\DoxyCodeLine{180     \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{181     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i)}
\DoxyCodeLine{182         \textcolor{keywordflow}{for} (j = 0; j < 4; ++j) M[i][j] = i < 3 \&\& j < 3 ? a[i] * b[j] : 0.f;}
\DoxyCodeLine{183 \}}
\DoxyCodeLine{184 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_rotate(mat4x4 R, mat4x4 M, \textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} y, \textcolor{keywordtype}{float} z, \textcolor{keywordtype}{float} angle) \{}
\DoxyCodeLine{185     \textcolor{keywordtype}{float} s = sinf(angle);}
\DoxyCodeLine{186     \textcolor{keywordtype}{float} c = cosf(angle);}
\DoxyCodeLine{187     vec3 u = \{x, y, z\};}
\DoxyCodeLine{188 }
\DoxyCodeLine{189     \textcolor{keywordflow}{if} (vec3\_len(u) > 1e-\/4) \{}
\DoxyCodeLine{190         vec3\_norm(u, u);}
\DoxyCodeLine{191         mat4x4 T;}
\DoxyCodeLine{192         mat4x4\_from\_vec3\_mul\_outer(T, u, u);}
\DoxyCodeLine{193 }
\DoxyCodeLine{194         mat4x4 S = \{\{0, u[2], -\/u[1], 0\}, \{-\/u[2], 0, u[0], 0\}, \{u[1], -\/u[0], 0, 0\}, \{0, 0, 0, 0\}\};}
\DoxyCodeLine{195         mat4x4\_scale(S, S, s);}
\DoxyCodeLine{196 }
\DoxyCodeLine{197         mat4x4 C;}
\DoxyCodeLine{198         mat4x4\_identity(C);}
\DoxyCodeLine{199         mat4x4\_sub(C, C, T);}
\DoxyCodeLine{200 }
\DoxyCodeLine{201         mat4x4\_scale(C, C, c);}
\DoxyCodeLine{202 }
\DoxyCodeLine{203         mat4x4\_add(T, T, C);}
\DoxyCodeLine{204         mat4x4\_add(T, T, S);}
\DoxyCodeLine{205 }
\DoxyCodeLine{206         T[3][3] = 1.;}
\DoxyCodeLine{207         mat4x4\_mul(R, M, T);}
\DoxyCodeLine{208     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{209         mat4x4\_dup(R, M);}
\DoxyCodeLine{210     \}}
\DoxyCodeLine{211 \}}
\DoxyCodeLine{212 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_rotate\_X(mat4x4 Q, mat4x4 M, \textcolor{keywordtype}{float} angle) \{}
\DoxyCodeLine{213     \textcolor{keywordtype}{float} s = sinf(angle);}
\DoxyCodeLine{214     \textcolor{keywordtype}{float} c = cosf(angle);}
\DoxyCodeLine{215     mat4x4 R = \{\{1.f, 0.f, 0.f, 0.f\}, \{0.f, c, s, 0.f\}, \{0.f, -\/s, c, 0.f\}, \{0.f, 0.f, 0.f, 1.f\}\};}
\DoxyCodeLine{216     mat4x4\_mul(Q, M, R);}
\DoxyCodeLine{217 \}}
\DoxyCodeLine{218 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_rotate\_Y(mat4x4 Q, mat4x4 M, \textcolor{keywordtype}{float} angle) \{}
\DoxyCodeLine{219     \textcolor{keywordtype}{float} s = sinf(angle);}
\DoxyCodeLine{220     \textcolor{keywordtype}{float} c = cosf(angle);}
\DoxyCodeLine{221     mat4x4 R = \{\{c, 0.f, s, 0.f\}, \{0.f, 1.f, 0.f, 0.f\}, \{-\/s, 0.f, c, 0.f\}, \{0.f, 0.f, 0.f, 1.f\}\};}
\DoxyCodeLine{222     mat4x4\_mul(Q, M, R);}
\DoxyCodeLine{223 \}}
\DoxyCodeLine{224 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_rotate\_Z(mat4x4 Q, mat4x4 M, \textcolor{keywordtype}{float} angle) \{}
\DoxyCodeLine{225     \textcolor{keywordtype}{float} s = sinf(angle);}
\DoxyCodeLine{226     \textcolor{keywordtype}{float} c = cosf(angle);}
\DoxyCodeLine{227     mat4x4 R = \{\{c, s, 0.f, 0.f\}, \{-\/s, c, 0.f, 0.f\}, \{0.f, 0.f, 1.f, 0.f\}, \{0.f, 0.f, 0.f, 1.f\}\};}
\DoxyCodeLine{228     mat4x4\_mul(Q, M, R);}
\DoxyCodeLine{229 \}}
\DoxyCodeLine{230 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_invert(mat4x4 T, mat4x4 M) \{}
\DoxyCodeLine{231     \textcolor{keywordtype}{float} s[6];}
\DoxyCodeLine{232     \textcolor{keywordtype}{float} c[6];}
\DoxyCodeLine{233     s[0] = M[0][0] * M[1][1] -\/ M[1][0] * M[0][1];}
\DoxyCodeLine{234     s[1] = M[0][0] * M[1][2] -\/ M[1][0] * M[0][2];}
\DoxyCodeLine{235     s[2] = M[0][0] * M[1][3] -\/ M[1][0] * M[0][3];}
\DoxyCodeLine{236     s[3] = M[0][1] * M[1][2] -\/ M[1][1] * M[0][2];}
\DoxyCodeLine{237     s[4] = M[0][1] * M[1][3] -\/ M[1][1] * M[0][3];}
\DoxyCodeLine{238     s[5] = M[0][2] * M[1][3] -\/ M[1][2] * M[0][3];}
\DoxyCodeLine{239 }
\DoxyCodeLine{240     c[0] = M[2][0] * M[3][1] -\/ M[3][0] * M[2][1];}
\DoxyCodeLine{241     c[1] = M[2][0] * M[3][2] -\/ M[3][0] * M[2][2];}
\DoxyCodeLine{242     c[2] = M[2][0] * M[3][3] -\/ M[3][0] * M[2][3];}
\DoxyCodeLine{243     c[3] = M[2][1] * M[3][2] -\/ M[3][1] * M[2][2];}
\DoxyCodeLine{244     c[4] = M[2][1] * M[3][3] -\/ M[3][1] * M[2][3];}
\DoxyCodeLine{245     c[5] = M[2][2] * M[3][3] -\/ M[3][2] * M[2][3];}
\DoxyCodeLine{246 }
\DoxyCodeLine{247     \textcolor{comment}{/* Assumes it is invertible */}}
\DoxyCodeLine{248     \textcolor{keywordtype}{float} idet = 1.0f / (s[0] * c[5] -\/ s[1] * c[4] + s[2] * c[3] + s[3] * c[2] -\/ s[4] * c[1] + s[5] * c[0]);}
\DoxyCodeLine{249 }
\DoxyCodeLine{250     T[0][0] = (M[1][1] * c[5] -\/ M[1][2] * c[4] + M[1][3] * c[3]) * idet;}
\DoxyCodeLine{251     T[0][1] = (-\/M[0][1] * c[5] + M[0][2] * c[4] -\/ M[0][3] * c[3]) * idet;}
\DoxyCodeLine{252     T[0][2] = (M[3][1] * s[5] -\/ M[3][2] * s[4] + M[3][3] * s[3]) * idet;}
\DoxyCodeLine{253     T[0][3] = (-\/M[2][1] * s[5] + M[2][2] * s[4] -\/ M[2][3] * s[3]) * idet;}
\DoxyCodeLine{254 }
\DoxyCodeLine{255     T[1][0] = (-\/M[1][0] * c[5] + M[1][2] * c[2] -\/ M[1][3] * c[1]) * idet;}
\DoxyCodeLine{256     T[1][1] = (M[0][0] * c[5] -\/ M[0][2] * c[2] + M[0][3] * c[1]) * idet;}
\DoxyCodeLine{257     T[1][2] = (-\/M[3][0] * s[5] + M[3][2] * s[2] -\/ M[3][3] * s[1]) * idet;}
\DoxyCodeLine{258     T[1][3] = (M[2][0] * s[5] -\/ M[2][2] * s[2] + M[2][3] * s[1]) * idet;}
\DoxyCodeLine{259 }
\DoxyCodeLine{260     T[2][0] = (M[1][0] * c[4] -\/ M[1][1] * c[2] + M[1][3] * c[0]) * idet;}
\DoxyCodeLine{261     T[2][1] = (-\/M[0][0] * c[4] + M[0][1] * c[2] -\/ M[0][3] * c[0]) * idet;}
\DoxyCodeLine{262     T[2][2] = (M[3][0] * s[4] -\/ M[3][1] * s[2] + M[3][3] * s[0]) * idet;}
\DoxyCodeLine{263     T[2][3] = (-\/M[2][0] * s[4] + M[2][1] * s[2] -\/ M[2][3] * s[0]) * idet;}
\DoxyCodeLine{264 }
\DoxyCodeLine{265     T[3][0] = (-\/M[1][0] * c[3] + M[1][1] * c[1] -\/ M[1][2] * c[0]) * idet;}
\DoxyCodeLine{266     T[3][1] = (M[0][0] * c[3] -\/ M[0][1] * c[1] + M[0][2] * c[0]) * idet;}
\DoxyCodeLine{267     T[3][2] = (-\/M[3][0] * s[3] + M[3][1] * s[1] -\/ M[3][2] * s[0]) * idet;}
\DoxyCodeLine{268     T[3][3] = (M[2][0] * s[3] -\/ M[2][1] * s[1] + M[2][2] * s[0]) * idet;}
\DoxyCodeLine{269 \}}
\DoxyCodeLine{270 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_orthonormalize(mat4x4 R, mat4x4 M) \{}
\DoxyCodeLine{271     mat4x4\_dup(R, M);}
\DoxyCodeLine{272     \textcolor{keywordtype}{float} s = 1.;}
\DoxyCodeLine{273     vec3 h;}
\DoxyCodeLine{274 }
\DoxyCodeLine{275     vec3\_norm(R[2], R[2]);}
\DoxyCodeLine{276 }
\DoxyCodeLine{277     s = vec3\_mul\_inner(R[1], R[2]);}
\DoxyCodeLine{278     vec3\_scale(h, R[2], s);}
\DoxyCodeLine{279     vec3\_sub(R[1], R[1], h);}
\DoxyCodeLine{280     vec3\_norm(R[2], R[2]);}
\DoxyCodeLine{281 }
\DoxyCodeLine{282     s = vec3\_mul\_inner(R[1], R[2]);}
\DoxyCodeLine{283     vec3\_scale(h, R[2], s);}
\DoxyCodeLine{284     vec3\_sub(R[1], R[1], h);}
\DoxyCodeLine{285     vec3\_norm(R[1], R[1]);}
\DoxyCodeLine{286 }
\DoxyCodeLine{287     s = vec3\_mul\_inner(R[0], R[1]);}
\DoxyCodeLine{288     vec3\_scale(h, R[1], s);}
\DoxyCodeLine{289     vec3\_sub(R[0], R[0], h);}
\DoxyCodeLine{290     vec3\_norm(R[0], R[0]);}
\DoxyCodeLine{291 \}}
\DoxyCodeLine{292 }
\DoxyCodeLine{293 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_frustum(mat4x4 M, \textcolor{keywordtype}{float} l, \textcolor{keywordtype}{float} r, \textcolor{keywordtype}{float} b, \textcolor{keywordtype}{float} t, \textcolor{keywordtype}{float} n, \textcolor{keywordtype}{float} f) \{}
\DoxyCodeLine{294     M[0][0] = 2.f * n / (r -\/ l);}
\DoxyCodeLine{295     M[0][1] = M[0][2] = M[0][3] = 0.f;}
\DoxyCodeLine{296 }
\DoxyCodeLine{297     M[1][1] = 2.f * n / (t -\/ b);}
\DoxyCodeLine{298     M[1][0] = M[1][2] = M[1][3] = 0.f;}
\DoxyCodeLine{299 }
\DoxyCodeLine{300     M[2][0] = (r + l) / (r -\/ l);}
\DoxyCodeLine{301     M[2][1] = (t + b) / (t -\/ b);}
\DoxyCodeLine{302     M[2][2] = -\/(f + n) / (f -\/ n);}
\DoxyCodeLine{303     M[2][3] = -\/1.f;}
\DoxyCodeLine{304 }
\DoxyCodeLine{305     M[3][2] = -\/2.f * (f * n) / (f -\/ n);}
\DoxyCodeLine{306     M[3][0] = M[3][1] = M[3][3] = 0.f;}
\DoxyCodeLine{307 \}}
\DoxyCodeLine{308 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_ortho(mat4x4 M, \textcolor{keywordtype}{float} l, \textcolor{keywordtype}{float} r, \textcolor{keywordtype}{float} b, \textcolor{keywordtype}{float} t, \textcolor{keywordtype}{float} n, \textcolor{keywordtype}{float} f) \{}
\DoxyCodeLine{309     M[0][0] = 2.f / (r -\/ l);}
\DoxyCodeLine{310     M[0][1] = M[0][2] = M[0][3] = 0.f;}
\DoxyCodeLine{311 }
\DoxyCodeLine{312     M[1][1] = 2.f / (t -\/ b);}
\DoxyCodeLine{313     M[1][0] = M[1][2] = M[1][3] = 0.f;}
\DoxyCodeLine{314 }
\DoxyCodeLine{315     M[2][2] = -\/2.f / (f -\/ n);}
\DoxyCodeLine{316     M[2][0] = M[2][1] = M[2][3] = 0.f;}
\DoxyCodeLine{317 }
\DoxyCodeLine{318     M[3][0] = -\/(r + l) / (r -\/ l);}
\DoxyCodeLine{319     M[3][1] = -\/(t + b) / (t -\/ b);}
\DoxyCodeLine{320     M[3][2] = -\/(f + n) / (f -\/ n);}
\DoxyCodeLine{321     M[3][3] = 1.f;}
\DoxyCodeLine{322 \}}
\DoxyCodeLine{323 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_perspective(mat4x4 m, \textcolor{keywordtype}{float} y\_fov, \textcolor{keywordtype}{float} aspect, \textcolor{keywordtype}{float} n, \textcolor{keywordtype}{float} f) \{}
\DoxyCodeLine{324     \textcolor{comment}{/* NOTE: Degrees are an unhandy unit to work with.}}
\DoxyCodeLine{325 \textcolor{comment}{     * linmath.h uses radians for everything! */}}
\DoxyCodeLine{326     \textcolor{keywordtype}{float} \textcolor{keyword}{const} a = (float)(1.f / tan(y\_fov / 2.f));}
\DoxyCodeLine{327 }
\DoxyCodeLine{328     m[0][0] = a / aspect;}
\DoxyCodeLine{329     m[0][1] = 0.f;}
\DoxyCodeLine{330     m[0][2] = 0.f;}
\DoxyCodeLine{331     m[0][3] = 0.f;}
\DoxyCodeLine{332 }
\DoxyCodeLine{333     m[1][0] = 0.f;}
\DoxyCodeLine{334     m[1][1] = a;}
\DoxyCodeLine{335     m[1][2] = 0.f;}
\DoxyCodeLine{336     m[1][3] = 0.f;}
\DoxyCodeLine{337 }
\DoxyCodeLine{338     m[2][0] = 0.f;}
\DoxyCodeLine{339     m[2][1] = 0.f;}
\DoxyCodeLine{340     m[2][2] = -\/((f + n) / (f -\/ n));}
\DoxyCodeLine{341     m[2][3] = -\/1.f;}
\DoxyCodeLine{342 }
\DoxyCodeLine{343     m[3][0] = 0.f;}
\DoxyCodeLine{344     m[3][1] = 0.f;}
\DoxyCodeLine{345     m[3][2] = -\/((2.f * f * n) / (f -\/ n));}
\DoxyCodeLine{346     m[3][3] = 0.f;}
\DoxyCodeLine{347 \}}
\DoxyCodeLine{348 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_look\_at(mat4x4 m, vec3 eye, vec3 center, vec3 up) \{}
\DoxyCodeLine{349     \textcolor{comment}{/* Adapted from Android's OpenGL Matrix.java.                        */}}
\DoxyCodeLine{350     \textcolor{comment}{/* See the OpenGL GLUT documentation for gluLookAt for a description */}}
\DoxyCodeLine{351     \textcolor{comment}{/* of the algorithm. We implement it in a straightforward way:       */}}
\DoxyCodeLine{352 }
\DoxyCodeLine{353     \textcolor{comment}{/* TODO: The negation of of can be spared by swapping the order of}}
\DoxyCodeLine{354 \textcolor{comment}{     *       operands in the following cross products in the right way. */}}
\DoxyCodeLine{355     vec3 f;}
\DoxyCodeLine{356     vec3\_sub(f, center, eye);}
\DoxyCodeLine{357     vec3\_norm(f, f);}
\DoxyCodeLine{358 }
\DoxyCodeLine{359     vec3 s;}
\DoxyCodeLine{360     vec3\_mul\_cross(s, f, up);}
\DoxyCodeLine{361     vec3\_norm(s, s);}
\DoxyCodeLine{362 }
\DoxyCodeLine{363     vec3 t;}
\DoxyCodeLine{364     vec3\_mul\_cross(t, s, f);}
\DoxyCodeLine{365 }
\DoxyCodeLine{366     m[0][0] = s[0];}
\DoxyCodeLine{367     m[0][1] = t[0];}
\DoxyCodeLine{368     m[0][2] = -\/f[0];}
\DoxyCodeLine{369     m[0][3] = 0.f;}
\DoxyCodeLine{370 }
\DoxyCodeLine{371     m[1][0] = s[1];}
\DoxyCodeLine{372     m[1][1] = t[1];}
\DoxyCodeLine{373     m[1][2] = -\/f[1];}
\DoxyCodeLine{374     m[1][3] = 0.f;}
\DoxyCodeLine{375 }
\DoxyCodeLine{376     m[2][0] = s[2];}
\DoxyCodeLine{377     m[2][1] = t[2];}
\DoxyCodeLine{378     m[2][2] = -\/f[2];}
\DoxyCodeLine{379     m[2][3] = 0.f;}
\DoxyCodeLine{380 }
\DoxyCodeLine{381     m[3][0] = 0.f;}
\DoxyCodeLine{382     m[3][1] = 0.f;}
\DoxyCodeLine{383     m[3][2] = 0.f;}
\DoxyCodeLine{384     m[3][3] = 1.f;}
\DoxyCodeLine{385 }
\DoxyCodeLine{386     mat4x4\_translate\_in\_place(m, -\/eye[0], -\/eye[1], -\/eye[2]);}
\DoxyCodeLine{387 \}}
\DoxyCodeLine{388 }
\DoxyCodeLine{389 \textcolor{keyword}{typedef} \textcolor{keywordtype}{float} quat[4];}
\DoxyCodeLine{390 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} quat\_identity(quat q) \{}
\DoxyCodeLine{391     q[0] = q[1] = q[2] = 0.f;}
\DoxyCodeLine{392     q[3] = 1.f;}
\DoxyCodeLine{393 \}}
\DoxyCodeLine{394 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} quat\_add(quat r, quat a, quat b) \{}
\DoxyCodeLine{395     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{396     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) r[i] = a[i] + b[i];}
\DoxyCodeLine{397 \}}
\DoxyCodeLine{398 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} quat\_sub(quat r, quat a, quat b) \{}
\DoxyCodeLine{399     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{400     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) r[i] = a[i] -\/ b[i];}
\DoxyCodeLine{401 \}}
\DoxyCodeLine{402 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} quat\_mul(quat r, quat p, quat q) \{}
\DoxyCodeLine{403     vec3 w;}
\DoxyCodeLine{404     vec3\_mul\_cross(r, p, q);}
\DoxyCodeLine{405     vec3\_scale(w, p, q[3]);}
\DoxyCodeLine{406     vec3\_add(r, r, w);}
\DoxyCodeLine{407     vec3\_scale(w, q, p[3]);}
\DoxyCodeLine{408     vec3\_add(r, r, w);}
\DoxyCodeLine{409     r[3] = p[3] * q[3] -\/ vec3\_mul\_inner(p, q);}
\DoxyCodeLine{410 \}}
\DoxyCodeLine{411 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} quat\_scale(quat r, quat v, \textcolor{keywordtype}{float} s) \{}
\DoxyCodeLine{412     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{413     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) r[i] = v[i] * s;}
\DoxyCodeLine{414 \}}
\DoxyCodeLine{415 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{float} quat\_inner\_product(quat a, quat b) \{}
\DoxyCodeLine{416     \textcolor{keywordtype}{float} p = 0.f;}
\DoxyCodeLine{417     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{418     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i) p += b[i] * a[i];}
\DoxyCodeLine{419     \textcolor{keywordflow}{return} p;}
\DoxyCodeLine{420 \}}
\DoxyCodeLine{421 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} quat\_conj(quat r, quat q) \{}
\DoxyCodeLine{422     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{423     \textcolor{keywordflow}{for} (i = 0; i < 3; ++i) r[i] = -\/q[i];}
\DoxyCodeLine{424     r[3] = q[3];}
\DoxyCodeLine{425 \}}
\DoxyCodeLine{426 \textcolor{preprocessor}{\#define quat\_norm vec4\_norm}}
\DoxyCodeLine{427 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} quat\_mul\_vec3(vec3 r, quat q, vec3 v) \{}
\DoxyCodeLine{428     quat v\_ = \{v[0], v[1], v[2], 0.f\};}
\DoxyCodeLine{429 }
\DoxyCodeLine{430     quat\_conj(r, q);}
\DoxyCodeLine{431     quat\_norm(r, r);}
\DoxyCodeLine{432     quat\_mul(r, v\_, r);}
\DoxyCodeLine{433     quat\_mul(r, q, r);}
\DoxyCodeLine{434 \}}
\DoxyCodeLine{435 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4\_from\_quat(mat4x4 M, quat q) \{}
\DoxyCodeLine{436     \textcolor{keywordtype}{float} a = q[3];}
\DoxyCodeLine{437     \textcolor{keywordtype}{float} b = q[0];}
\DoxyCodeLine{438     \textcolor{keywordtype}{float} c = q[1];}
\DoxyCodeLine{439     \textcolor{keywordtype}{float} d = q[2];}
\DoxyCodeLine{440     \textcolor{keywordtype}{float} a2 = a * a;}
\DoxyCodeLine{441     \textcolor{keywordtype}{float} b2 = b * b;}
\DoxyCodeLine{442     \textcolor{keywordtype}{float} c2 = c * c;}
\DoxyCodeLine{443     \textcolor{keywordtype}{float} d2 = d * d;}
\DoxyCodeLine{444 }
\DoxyCodeLine{445     M[0][0] = a2 + b2 -\/ c2 -\/ d2;}
\DoxyCodeLine{446     M[0][1] = 2.f * (b * c + a * d);}
\DoxyCodeLine{447     M[0][2] = 2.f * (b * d -\/ a * c);}
\DoxyCodeLine{448     M[0][3] = 0.f;}
\DoxyCodeLine{449 }
\DoxyCodeLine{450     M[1][0] = 2 * (b * c -\/ a * d);}
\DoxyCodeLine{451     M[1][1] = a2 -\/ b2 + c2 -\/ d2;}
\DoxyCodeLine{452     M[1][2] = 2.f * (c * d + a * b);}
\DoxyCodeLine{453     M[1][3] = 0.f;}
\DoxyCodeLine{454 }
\DoxyCodeLine{455     M[2][0] = 2.f * (b * d + a * c);}
\DoxyCodeLine{456     M[2][1] = 2.f * (c * d -\/ a * b);}
\DoxyCodeLine{457     M[2][2] = a2 -\/ b2 -\/ c2 + d2;}
\DoxyCodeLine{458     M[2][3] = 0.f;}
\DoxyCodeLine{459 }
\DoxyCodeLine{460     M[3][0] = M[3][1] = M[3][2] = 0.f;}
\DoxyCodeLine{461     M[3][3] = 1.f;}
\DoxyCodeLine{462 \}}
\DoxyCodeLine{463 }
\DoxyCodeLine{464 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} mat4x4o\_mul\_quat(mat4x4 R, mat4x4 M, quat q) \{}
\DoxyCodeLine{465     \textcolor{comment}{/*  XXX: The way this is written only works for othogonal matrices. */}}
\DoxyCodeLine{466     \textcolor{comment}{/* TODO: Take care of non-\/orthogonal case. */}}
\DoxyCodeLine{467     quat\_mul\_vec3(R[0], q, M[0]);}
\DoxyCodeLine{468     quat\_mul\_vec3(R[1], q, M[1]);}
\DoxyCodeLine{469     quat\_mul\_vec3(R[2], q, M[2]);}
\DoxyCodeLine{470 }
\DoxyCodeLine{471     R[3][0] = R[3][1] = R[3][2] = 0.f;}
\DoxyCodeLine{472     R[3][3] = 1.f;}
\DoxyCodeLine{473 \}}
\DoxyCodeLine{474 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} quat\_from\_mat4x4(quat q, mat4x4 M) \{}
\DoxyCodeLine{475     \textcolor{keywordtype}{float} r = 0.f;}
\DoxyCodeLine{476     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{477 }
\DoxyCodeLine{478     \textcolor{keywordtype}{int} perm[] = \{0, 1, 2, 0, 1\};}
\DoxyCodeLine{479     \textcolor{keywordtype}{int} *p = perm;}
\DoxyCodeLine{480 }
\DoxyCodeLine{481     \textcolor{keywordflow}{for} (i = 0; i < 3; i++) \{}
\DoxyCodeLine{482         \textcolor{keywordtype}{float} m = M[i][i];}
\DoxyCodeLine{483         \textcolor{keywordflow}{if} (m < r) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{484         m = r;}
\DoxyCodeLine{485         p = \&perm[i];}
\DoxyCodeLine{486     \}}
\DoxyCodeLine{487 }
\DoxyCodeLine{488     r = sqrtf(1.f + M[p[0]][p[0]] -\/ M[p[1]][p[1]] -\/ M[p[2]][p[2]]);}
\DoxyCodeLine{489 }
\DoxyCodeLine{490     \textcolor{keywordflow}{if} (r < 1e-\/6) \{}
\DoxyCodeLine{491         q[0] = 1.f;}
\DoxyCodeLine{492         q[1] = q[2] = q[3] = 0.f;}
\DoxyCodeLine{493         \textcolor{keywordflow}{return};}
\DoxyCodeLine{494     \}}
\DoxyCodeLine{495 }
\DoxyCodeLine{496     q[0] = r / 2.f;}
\DoxyCodeLine{497     q[1] = (M[p[0]][p[1]] -\/ M[p[1]][p[0]]) / (2.f * r);}
\DoxyCodeLine{498     q[2] = (M[p[2]][p[0]] -\/ M[p[0]][p[2]]) / (2.f * r);}
\DoxyCodeLine{499     q[3] = (M[p[2]][p[1]] -\/ M[p[1]][p[2]]) / (2.f * r);}
\DoxyCodeLine{500 \}}
\DoxyCodeLine{501 }
\DoxyCodeLine{502 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
