\hypertarget{common_8h_source}{}\doxysection{common.\+h}
\label{common_8h_source}\index{/Users/pvelesko/local/CHIP-\/SPV/spdlog/common.h@{/Users/pvelesko/local/CHIP-\/SPV/spdlog/common.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//}}
\DoxyCodeLine{2 \textcolor{comment}{// Copyright(c) 2015 Gabi Melman.}}
\DoxyCodeLine{3 \textcolor{comment}{// Distributed under the MIT License (http://opensource.org/licenses/MIT)}}
\DoxyCodeLine{4 \textcolor{comment}{//}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}spdlog/tweakme.h"{}}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <atomic>}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <chrono>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <initializer\_list>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <stdexcept>}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <cstring>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <type\_traits>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#if defined(SPDLOG\_WCHAR\_FILENAMES) || defined(SPDLOG\_WCHAR\_TO\_UTF8\_SUPPORT)}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <codecvt>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <locale>}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include "{}spdlog/details/null\_mutex.h"{}}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include "{}spdlog/fmt/fmt.h"{}}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{comment}{// visual studio upto 2013 does not support noexcept nor constexpr}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) \&\& (\_MSC\_VER < 1900)}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#define SPDLOG\_NOEXCEPT throw()}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#define SPDLOG\_CONSTEXPR}}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#define SPDLOG\_NOEXCEPT noexcept}}
\DoxyCodeLine{36 \textcolor{preprocessor}{\#define SPDLOG\_CONSTEXPR constexpr}}
\DoxyCodeLine{37 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{preprocessor}{\#if defined(\_\_GNUC\_\_) || defined(\_\_clang\_\_)}}
\DoxyCodeLine{40 \textcolor{preprocessor}{\#define SPDLOG\_DEPRECATED \_\_attribute\_\_((deprecated))}}
\DoxyCodeLine{41 \textcolor{preprocessor}{\#elif defined(\_MSC\_VER)}}
\DoxyCodeLine{42 \textcolor{preprocessor}{\#define SPDLOG\_DEPRECATED \_\_declspec(deprecated)}}
\DoxyCodeLine{43 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{44 \textcolor{preprocessor}{\#define SPDLOG\_DEPRECATED}}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{46 }
\DoxyCodeLine{47 \textcolor{comment}{// disable thread local on msvc 2013}}
\DoxyCodeLine{48 \textcolor{preprocessor}{\#ifndef SPDLOG\_NO\_TLS}}
\DoxyCodeLine{49 \textcolor{preprocessor}{\#if (defined(\_MSC\_VER) \&\& (\_MSC\_VER < 1900))}}
\DoxyCodeLine{50 \textcolor{preprocessor}{\#define SPDLOG\_NO\_TLS 1}}
\DoxyCodeLine{51 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{52 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54 \textcolor{comment}{// Get the basename of \_\_FILE\_\_ (at compile time if possible)}}
\DoxyCodeLine{55 \textcolor{preprocessor}{\#if FMT\_HAS\_FEATURE(\_\_builtin\_strrchr)}}
\DoxyCodeLine{56 \textcolor{preprocessor}{\#define SPDLOG\_STRRCHR(str, sep) \_\_builtin\_strrchr(str, sep)}}
\DoxyCodeLine{57 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{58 \textcolor{preprocessor}{\#define SPDLOG\_STRRCHR(str, sep) strrchr(str, sep)}}
\DoxyCodeLine{59 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{//\_\_builtin\_strrchr not defined}}
\DoxyCodeLine{60 }
\DoxyCodeLine{61 \textcolor{preprocessor}{\#ifdef \_WIN32}}
\DoxyCodeLine{62 \textcolor{preprocessor}{\#define SPDLOG\_FILE\_BASENAME(file) SPDLOG\_STRRCHR("{}\(\backslash\)\(\backslash\)"{}} file, '\(\backslash\)\(\backslash\)') + 1}
\DoxyCodeLine{63 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{64 \textcolor{preprocessor}{\#define SPDLOG\_FILE\_BASENAME(file) SPDLOG\_STRRCHR("{}/"{}} file, '/') + 1}
\DoxyCodeLine{65 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{66 }
\DoxyCodeLine{67 \textcolor{keyword}{namespace }spdlog \{}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 \textcolor{keyword}{class }\mbox{\hyperlink{structformatter}{formatter}};}
\DoxyCodeLine{70 }
\DoxyCodeLine{71 \textcolor{keyword}{namespace }sinks \{}
\DoxyCodeLine{72 \textcolor{keyword}{class }sink;}
\DoxyCodeLine{73 \}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75 \textcolor{keyword}{using} log\_clock = std::chrono::system\_clock;}
\DoxyCodeLine{76 \textcolor{keyword}{using} sink\_ptr = std::shared\_ptr<sinks::sink>;}
\DoxyCodeLine{77 \textcolor{keyword}{using} sinks\_init\_list = std::initializer\_list<sink\_ptr>;}
\DoxyCodeLine{78 \textcolor{keyword}{using} log\_err\_handler = std::function<void(\textcolor{keyword}{const} std::string \&err\_msg)>;}
\DoxyCodeLine{79 }
\DoxyCodeLine{80 \textcolor{comment}{// string\_view type -\/ either std::string\_view or fmt::string\_view (pre c++17)}}
\DoxyCodeLine{81 \textcolor{preprocessor}{\#if defined(FMT\_USE\_STD\_STRING\_VIEW)}}
\DoxyCodeLine{82 \textcolor{keyword}{using} string\_view\_t = std::string\_view;}
\DoxyCodeLine{83 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{84 \textcolor{keyword}{using} string\_view\_t = fmt::string\_view;}
\DoxyCodeLine{85 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{86 }
\DoxyCodeLine{87 \textcolor{preprocessor}{\#if defined(SPDLOG\_NO\_ATOMIC\_LEVELS)}}
\DoxyCodeLine{88 \textcolor{keyword}{using} level\_t = details::null\_atomic\_int;}
\DoxyCodeLine{89 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{90 \textcolor{keyword}{using} level\_t = std::atomic<int>;}
\DoxyCodeLine{91 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{92 }
\DoxyCodeLine{93 \textcolor{preprocessor}{\#define SPDLOG\_LEVEL\_TRACE 0}}
\DoxyCodeLine{94 \textcolor{preprocessor}{\#define SPDLOG\_LEVEL\_DEBUG 1}}
\DoxyCodeLine{95 \textcolor{preprocessor}{\#define SPDLOG\_LEVEL\_INFO 2}}
\DoxyCodeLine{96 \textcolor{preprocessor}{\#define SPDLOG\_LEVEL\_WARN 3}}
\DoxyCodeLine{97 \textcolor{preprocessor}{\#define SPDLOG\_LEVEL\_ERROR 4}}
\DoxyCodeLine{98 \textcolor{preprocessor}{\#define SPDLOG\_LEVEL\_CRITICAL 5}}
\DoxyCodeLine{99 \textcolor{preprocessor}{\#define SPDLOG\_LEVEL\_OFF 6}}
\DoxyCodeLine{100 }
\DoxyCodeLine{101 \textcolor{preprocessor}{\#if !defined(SPDLOG\_ACTIVE\_LEVEL)}}
\DoxyCodeLine{102 \textcolor{preprocessor}{\#define SPDLOG\_ACTIVE\_LEVEL SPDLOG\_LEVEL\_TRACE}}
\DoxyCodeLine{103 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{104 }
\DoxyCodeLine{105 \textcolor{comment}{// Log level enum}}
\DoxyCodeLine{106 \textcolor{keyword}{namespace }level \{}
\DoxyCodeLine{107 \textcolor{keyword}{enum} level\_enum \{}
\DoxyCodeLine{108   trace = SPDLOG\_LEVEL\_TRACE,}
\DoxyCodeLine{109   debug = SPDLOG\_LEVEL\_DEBUG,}
\DoxyCodeLine{110   info = SPDLOG\_LEVEL\_INFO,}
\DoxyCodeLine{111   warn = SPDLOG\_LEVEL\_WARN,}
\DoxyCodeLine{112   err = SPDLOG\_LEVEL\_ERROR,}
\DoxyCodeLine{113   critical = SPDLOG\_LEVEL\_CRITICAL,}
\DoxyCodeLine{114   off = SPDLOG\_LEVEL\_OFF,}
\DoxyCodeLine{115 \};}
\DoxyCodeLine{116 }
\DoxyCodeLine{117 \textcolor{preprocessor}{\#if !defined(SPDLOG\_LEVEL\_NAMES)}}
\DoxyCodeLine{118 \textcolor{preprocessor}{\#define SPDLOG\_LEVEL\_NAMES \(\backslash\)}}
\DoxyCodeLine{119 \textcolor{preprocessor}{  \{ "{}trace"{}}, "{}debug"{}, "{}info"{}, "{}warning"{}, "{}error"{}, "{}critical"{}, "{}off"{} \}}
\DoxyCodeLine{120 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{121 }
\DoxyCodeLine{122 \textcolor{keyword}{static} string\_view\_t level\_string\_views[] SPDLOG\_LEVEL\_NAMES;}
\DoxyCodeLine{123 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{char} *short\_level\_names[]\{\textcolor{stringliteral}{"{}T"{}}, \textcolor{stringliteral}{"{}D"{}}, \textcolor{stringliteral}{"{}I"{}}, \textcolor{stringliteral}{"{}W"{}}, \textcolor{stringliteral}{"{}E"{}}, \textcolor{stringliteral}{"{}C"{}}, \textcolor{stringliteral}{"{}O"{}}\};}
\DoxyCodeLine{124 }
\DoxyCodeLine{125 \textcolor{keyword}{inline} string\_view\_t \&to\_string\_view(spdlog::level::level\_enum l)}
\DoxyCodeLine{126     SPDLOG\_NOEXCEPT \{}
\DoxyCodeLine{127   \textcolor{keywordflow}{return} level\_string\_views[l];}
\DoxyCodeLine{128 \}}
\DoxyCodeLine{129 }
\DoxyCodeLine{130 \textcolor{keyword}{inline} \textcolor{keyword}{const} \textcolor{keywordtype}{char} *to\_short\_c\_str(spdlog::level::level\_enum l) SPDLOG\_NOEXCEPT \{}
\DoxyCodeLine{131   \textcolor{keywordflow}{return} short\_level\_names[l];}
\DoxyCodeLine{132 \}}
\DoxyCodeLine{133 }
\DoxyCodeLine{134 \textcolor{keyword}{inline} spdlog::level::level\_enum from\_str(\textcolor{keyword}{const} std::string \&name)}
\DoxyCodeLine{135     SPDLOG\_NOEXCEPT \{}
\DoxyCodeLine{136   \textcolor{keywordtype}{int} level = 0;}
\DoxyCodeLine{137   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&level\_str : level\_string\_views) \{}
\DoxyCodeLine{138     \textcolor{keywordflow}{if} (level\_str == name) \{}
\DoxyCodeLine{139       \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}level::level\_enum\textcolor{keyword}{>}(level);}
\DoxyCodeLine{140     \}}
\DoxyCodeLine{141     level++;}
\DoxyCodeLine{142   \}}
\DoxyCodeLine{143   \textcolor{keywordflow}{return} level::off;}
\DoxyCodeLine{144 \}}
\DoxyCodeLine{145 }
\DoxyCodeLine{146 \textcolor{keyword}{using} level\_hasher = std::hash<int>;}
\DoxyCodeLine{147 \}  \textcolor{comment}{// namespace level}}
\DoxyCodeLine{148 }
\DoxyCodeLine{149 \textcolor{comment}{//}}
\DoxyCodeLine{150 \textcolor{comment}{// Pattern time -\/ specific time getting to use for pattern\_formatter.}}
\DoxyCodeLine{151 \textcolor{comment}{// local time by default}}
\DoxyCodeLine{152 \textcolor{comment}{//}}
\DoxyCodeLine{153 \textcolor{keyword}{enum class} pattern\_time\_type \{}
\DoxyCodeLine{154   local,  \textcolor{comment}{// log localtime}}
\DoxyCodeLine{155   utc     \textcolor{comment}{// log utc}}
\DoxyCodeLine{156 \};}
\DoxyCodeLine{157 }
\DoxyCodeLine{158 \textcolor{comment}{//}}
\DoxyCodeLine{159 \textcolor{comment}{// Log exception}}
\DoxyCodeLine{160 \textcolor{comment}{//}}
\DoxyCodeLine{161 \textcolor{keyword}{class }\mbox{\hyperlink{classspdlog_1_1spdlog__ex}{spdlog\_ex}} : \textcolor{keyword}{public} std::exception \{}
\DoxyCodeLine{162  \textcolor{keyword}{public}:}
\DoxyCodeLine{163   \textcolor{keyword}{explicit} \mbox{\hyperlink{classspdlog_1_1spdlog__ex}{spdlog\_ex}}(std::string msg) : msg\_(std::move(msg)) \{\}}
\DoxyCodeLine{164 }
\DoxyCodeLine{165   \mbox{\hyperlink{classspdlog_1_1spdlog__ex}{spdlog\_ex}}(\textcolor{keyword}{const} std::string \&msg, \textcolor{keywordtype}{int} last\_errno) \{}
\DoxyCodeLine{166     fmt::memory\_buffer outbuf;}
\DoxyCodeLine{167     fmt::format\_system\_error(outbuf, last\_errno, msg);}
\DoxyCodeLine{168     msg\_ = fmt::to\_string(outbuf);}
\DoxyCodeLine{169   \}}
\DoxyCodeLine{170 }
\DoxyCodeLine{171   \textcolor{keyword}{const} \textcolor{keywordtype}{char} *what() \textcolor{keyword}{const} SPDLOG\_NOEXCEPT \textcolor{keyword}{override} \{ \textcolor{keywordflow}{return} msg\_.c\_str(); \}}
\DoxyCodeLine{172 }
\DoxyCodeLine{173  \textcolor{keyword}{private}:}
\DoxyCodeLine{174   std::string msg\_;}
\DoxyCodeLine{175 \};}
\DoxyCodeLine{176 }
\DoxyCodeLine{177 \textcolor{comment}{//}}
\DoxyCodeLine{178 \textcolor{comment}{// wchar support for windows file names (SPDLOG\_WCHAR\_FILENAMES must be defined)}}
\DoxyCodeLine{179 \textcolor{comment}{//}}
\DoxyCodeLine{180 \textcolor{preprocessor}{\#if defined(\_WIN32) \&\& defined(SPDLOG\_WCHAR\_FILENAMES)}}
\DoxyCodeLine{181 \textcolor{keyword}{using} filename\_t = std::wstring;}
\DoxyCodeLine{182 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{183 \textcolor{keyword}{using} filename\_t = std::string;}
\DoxyCodeLine{184 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{185 }
\DoxyCodeLine{186 \textcolor{keyword}{struct }\mbox{\hyperlink{structspdlog_1_1source__loc}{source\_loc}} \{}
\DoxyCodeLine{187   SPDLOG\_CONSTEXPR \mbox{\hyperlink{structspdlog_1_1source__loc}{source\_loc}}() : filename\{\textcolor{stringliteral}{"{}"{}}\}, line\{0\} \{\}}
\DoxyCodeLine{188   SPDLOG\_CONSTEXPR \mbox{\hyperlink{structspdlog_1_1source__loc}{source\_loc}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *filename, \textcolor{keywordtype}{int} line)}
\DoxyCodeLine{189       : filename\{filename\}, line\{\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(line)\} \{\}}
\DoxyCodeLine{190 }
\DoxyCodeLine{191   SPDLOG\_CONSTEXPR \textcolor{keywordtype}{bool} empty() \textcolor{keyword}{const} SPDLOG\_NOEXCEPT \{ \textcolor{keywordflow}{return} line == 0; \}}
\DoxyCodeLine{192   \textcolor{keyword}{const} \textcolor{keywordtype}{char} *filename;}
\DoxyCodeLine{193   uint32\_t line;}
\DoxyCodeLine{194 \};}
\DoxyCodeLine{195 }
\DoxyCodeLine{196 \textcolor{keyword}{namespace }details \{}
\DoxyCodeLine{197 \textcolor{comment}{// make\_unique support for pre c++14}}
\DoxyCodeLine{198 }
\DoxyCodeLine{199 \textcolor{preprocessor}{\#if \_\_cplusplus >= 201402L  }\textcolor{comment}{// C++14 and beyond}}
\DoxyCodeLine{200 \textcolor{keyword}{using} std::make\_unique;}
\DoxyCodeLine{201 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{202 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T, \textcolor{keyword}{typename}... Args>}
\DoxyCodeLine{203 std::unique\_ptr<T> make\_unique(Args \&\&...args) \{}
\DoxyCodeLine{204   \textcolor{keyword}{static\_assert}(!std::is\_array<T>::value, \textcolor{stringliteral}{"{}arrays not supported"{}});}
\DoxyCodeLine{205   \textcolor{keywordflow}{return} std::unique\_ptr<T>(\textcolor{keyword}{new} T(std::forward<Args>(args)...));}
\DoxyCodeLine{206 \}}
\DoxyCodeLine{207 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{208 \}  \textcolor{comment}{// namespace details}}
\DoxyCodeLine{209 \}  \textcolor{comment}{// namespace spdlog}}

\end{DoxyCode}
