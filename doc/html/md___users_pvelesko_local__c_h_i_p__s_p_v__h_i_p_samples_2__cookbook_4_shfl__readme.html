<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CHIP-SPV: Warp shfl operations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CHIP-SPV<span id="projectnumber">&#160;0.1.0</span>
   </div>
   <div id="projectbrief">Multiple backend interface for HIP</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Warp shfl operations </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >In this tutorial, we'll explain how to use the warp shfl operations to improve the performance.</p>
<h1><a class="anchor" id="autotoc_md916"></a>
Introduction:</h1>
<p >Let's talk about Warp first. The kernel code is executed in groups of fixed number of threads known as Warp. For nvidia WarpSize is 32 while for AMD, 32 for Polaris architecture and 64 for rest. Threads in a warp are referred to as lanes and are numbered from 0 to warpSize -1. With the help of shfl ops, we can directly exchange values of variable between threads without using any memory ops within a warp. There are four types of shfl ops: </p><div class="fragment"><div class="line">int   __shfl      (int var,   int srcLane, int width=warpSize);</div>
<div class="line">float __shfl      (float var, int srcLane, int width=warpSize);</div>
<div class="line">int   __shfl_up   (int var,   unsigned int delta, int width=warpSize);</div>
<div class="line">float __shfl_up   (float var, unsigned int delta, int width=warpSize);</div>
<div class="line">int   __shfl_down (int var,   unsigned int delta, int width=warpSize);</div>
<div class="line">float __shfl_down (float var, unsigned int delta, int width=warpSize);</div>
<div class="line">int   __shfl_xor  (int var,   int laneMask, int width=warpSize)</div>
<div class="line">float __shfl_xor  (float var, int laneMask, int width=warpSize);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md917"></a>
Requirement:</h1>
<p >For hardware requirement and software installation <a href="https://github.com/ROCm-Developer-Tools/HIP/blob/master/INSTALL.md">Installation</a></p>
<h1><a class="anchor" id="autotoc_md918"></a>
prerequiste knowledge:</h1>
<p >Programmers familiar with CUDA, OpenCL will be able to quickly learn and start coding with the HIP API. In case you are not, don't worry. You choose to start with the best one. We'll be explaining everything assuming you are completely new to gpgpu programming.</p>
<h1><a class="anchor" id="autotoc_md919"></a>
Simple Matrix Transpose</h1>
<p >We will be using the Simple Matrix Transpose application from the previous tutorial and modify it to learn how to use shared memory.</p>
<h1><a class="anchor" id="autotoc_md920"></a>
__shfl ops</h1>
<p >In this tutorial, we'll use <code>__shfl()</code> ops. In the same sourcecode, we used for MatrixTranspose. We'll add the following:</p>
<p ><code>out[i*width + j] = __shfl(val,j*width + i);</code></p>
<p >Be careful while using shfl operations, since all exchanges are possible between the threads of corresponding warp only.</p>
<h1><a class="anchor" id="autotoc_md921"></a>
How to build and run:</h1>
<p >Use the make command and execute it using ./exe Use hipcc to build the application, which is using hcc on AMD and nvcc on nvidia.</p>
<h1><a class="anchor" id="autotoc_md922"></a>
requirement for nvidia</h1>
<p >please make sure you have a 3.0 or higher compute capable device in order to use warp shfl operations and add <code>-gencode arch=compute=30, code=sm_30</code> nvcc flag in the Makefile while using this application.</p>
<h1><a class="anchor" id="autotoc_md923"></a>
More Info:</h1>
<ul>
<li><a href="https://github.com/ROCm-Developer-Tools/HIP/blob/master/docs/markdown/hip_faq.md">HIP FAQ</a></li>
<li><a href="https://github.com/ROCm-Developer-Tools/HIP/blob/master/docs/markdown/hip_kernel_language.md">HIP Kernel Language</a></li>
<li><a href="http://rocm-developer-tools.github.io/HIP">HIP Runtime API (Doxygen)</a></li>
<li><a href="https://github.com/ROCm-Developer-Tools/HIP/blob/master/docs/markdown/hip_porting_guide.md">HIP Porting Guide</a></li>
<li><a href="https://github.com/ROCm-Developer-Tools/HIP/blob/master/docs/markdown/hip_terms.md">HIP Terminology</a> (including Rosetta Stone of GPU computing terms across CUDA/HIP/HC/AMP/OpenL)</li>
<li><a href="https://github.com/ROCm-Developer-Tools/HIPIFY/blob/master/README.md">HIPIFY</a></li>
<li><a href="https://github.com/ROCm-Developer-Tools/HIP/blob/master/CONTRIBUTING.md">Developer/CONTRIBUTING Info</a></li>
<li><a href="https://github.com/ROCm-Developer-Tools/HIP/blob/master/RELEASE.md">Release Notes</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
