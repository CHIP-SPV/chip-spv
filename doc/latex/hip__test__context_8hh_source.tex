\hypertarget{hip__test__context_8hh_source}{}\doxysection{hip\+\_\+test\+\_\+context.\+hh}
\label{hip__test__context_8hh_source}\index{/Users/pvelesko/local/CHIP-\/SPV/HIP/tests/catch/include/hip\_test\_context.hh@{/Users/pvelesko/local/CHIP-\/SPV/HIP/tests/catch/include/hip\_test\_context.hh}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{Copyright (c) 2021 Advanced Micro Devices, Inc. All rights reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{}}
\DoxyCodeLine{4 \textcolor{comment}{Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{5 \textcolor{comment}{of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{6 \textcolor{comment}{in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{7 \textcolor{comment}{to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{8 \textcolor{comment}{copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{9 \textcolor{comment}{furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{10 \textcolor{comment}{}}
\DoxyCodeLine{11 \textcolor{comment}{The above copyright notice and this permission notice shall be included in}}
\DoxyCodeLine{12 \textcolor{comment}{all copies or substantial portions of the Software.}}
\DoxyCodeLine{13 \textcolor{comment}{}}
\DoxyCodeLine{14 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{15 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{16 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE}}
\DoxyCodeLine{17 \textcolor{comment}{AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{18 \textcolor{comment}{LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{19 \textcolor{comment}{OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN}}
\DoxyCodeLine{20 \textcolor{comment}{THE SOFTWARE.}}
\DoxyCodeLine{21 \textcolor{comment}{*/}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <hip/hip\_runtime.h>}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include <set>}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{preprocessor}{\#if defined(\_WIN32)}}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#define HT\_WIN 1}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#define HT\_LINUX 0}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#elif defined(\_\_linux\_\_)}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#define HT\_WIN 0}}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#define HT\_LINUX 1}}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{36 \textcolor{preprocessor}{\#error "{}OS not recognized"{}}}
\DoxyCodeLine{37 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{preprocessor}{\#if defined(\_\_HIP\_PLATFORM\_HCC\_\_) || defined(\_\_HIP\_PLATFORM\_AMD\_\_)}}
\DoxyCodeLine{40 \textcolor{preprocessor}{\#define HT\_AMD 1}}
\DoxyCodeLine{41 \textcolor{preprocessor}{\#define HT\_NVIDIA 0}}
\DoxyCodeLine{42 \textcolor{preprocessor}{\#define HT\_SPIRV 0}}
\DoxyCodeLine{43 \textcolor{preprocessor}{\#elif defined(\_\_HIP\_PLATFORM\_NVCC\_\_) || defined(\_\_HIP\_PLATFORM\_NVIDIA\_\_)}}
\DoxyCodeLine{44 \textcolor{preprocessor}{\#define HT\_AMD 0}}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#define HT\_NVIDIA 1}}
\DoxyCodeLine{46 \textcolor{preprocessor}{\#define HT\_SPIRV 0}}
\DoxyCodeLine{47 \textcolor{preprocessor}{\#elif defined(\_\_HIP\_PLATFORM\_CLANG\_\_) || defined(\_\_HIP\_PLATFORM\_SPIRV\_\_)}}
\DoxyCodeLine{48 \textcolor{preprocessor}{\#define HT\_AMD 0}}
\DoxyCodeLine{49 \textcolor{preprocessor}{\#define HT\_NVIDIA 0}}
\DoxyCodeLine{50 \textcolor{preprocessor}{\#define HT\_SPIRV 1}}
\DoxyCodeLine{51 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{52 \textcolor{preprocessor}{\#error "{}Platform not recognized"{}}}
\DoxyCodeLine{53 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 \textcolor{keyword}{static} \textcolor{keywordtype}{int} \_log\_enable = (std::getenv(\textcolor{stringliteral}{"{}HT\_LOG\_ENABLE"{}}) ? 1 : 0);}
\DoxyCodeLine{56 }
\DoxyCodeLine{57 \textcolor{preprocessor}{\#define LogPrintf(format, ...)                                                                     \(\backslash\)}}
\DoxyCodeLine{58 \textcolor{preprocessor}{  \{                                                                                                \(\backslash\)}}
\DoxyCodeLine{59 \textcolor{preprocessor}{    if (\_log\_enable) \{                                                                             \(\backslash\)}}
\DoxyCodeLine{60 \textcolor{preprocessor}{      printf(format, \_\_VA\_ARGS\_\_);                                                                 \(\backslash\)}}
\DoxyCodeLine{61 \textcolor{preprocessor}{      printf("{}\%c"{}}, '\(\backslash\)n');                                                                          \(\backslash\)}
\DoxyCodeLine{62     \}                                                                                              \(\backslash\)}
\DoxyCodeLine{63   \}}
\DoxyCodeLine{64 }
\DoxyCodeLine{65 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\mbox{\hyperlink{struct_config__}{Config\_}} \{}
\DoxyCodeLine{66   std::string json\_file;  \textcolor{comment}{// Json file}}
\DoxyCodeLine{67   std::string platform;   \textcolor{comment}{// amd/nvidia}}
\DoxyCodeLine{68   std::string os;         \textcolor{comment}{// windows/linux}}
\DoxyCodeLine{69 \} \mbox{\hyperlink{struct_config__}{Config}};}
\DoxyCodeLine{70 }
\DoxyCodeLine{71 \textcolor{keyword}{class }\mbox{\hyperlink{class_test_context}{TestContext}} \{}
\DoxyCodeLine{72   \textcolor{keywordtype}{bool} p\_windows = \textcolor{keyword}{false}, p\_linux = \textcolor{keyword}{false};  \textcolor{comment}{// OS}}
\DoxyCodeLine{73   \textcolor{keywordtype}{bool} amd = \textcolor{keyword}{false}, nvidia = \textcolor{keyword}{false};         \textcolor{comment}{// HIP Platform}}
\DoxyCodeLine{74   std::string exe\_path;}
\DoxyCodeLine{75   std::string current\_test;}
\DoxyCodeLine{76   std::set<std::string> skip\_test;}
\DoxyCodeLine{77 }
\DoxyCodeLine{78   \mbox{\hyperlink{struct_config__}{Config}} config\_;}
\DoxyCodeLine{79 }
\DoxyCodeLine{80   \textcolor{keywordtype}{void} detectOS();}
\DoxyCodeLine{81   \textcolor{keywordtype}{void} detectPlatform();}
\DoxyCodeLine{82   \textcolor{keywordtype}{void} fillConfig();}
\DoxyCodeLine{83   \textcolor{keywordtype}{void} setExePath(\textcolor{keywordtype}{int}, \textcolor{keywordtype}{char}**);}
\DoxyCodeLine{84   \textcolor{keywordtype}{void} parseOptions(\textcolor{keywordtype}{int}, \textcolor{keywordtype}{char}**);}
\DoxyCodeLine{85   \textcolor{keywordtype}{bool} parseJsonFile();}
\DoxyCodeLine{86   \textcolor{keyword}{const} \mbox{\hyperlink{struct_config__}{Config}}\& getConfig()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} config\_; \}}
\DoxyCodeLine{87 }
\DoxyCodeLine{88   \mbox{\hyperlink{class_test_context}{TestContext}}(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char}** argv);}
\DoxyCodeLine{89 }
\DoxyCodeLine{90  \textcolor{keyword}{public}:}
\DoxyCodeLine{91   \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{class_test_context}{TestContext}}\& get(\textcolor{keywordtype}{int} argc = 0, \textcolor{keywordtype}{char}** argv = \textcolor{keyword}{nullptr}) \{}
\DoxyCodeLine{92     \textcolor{keyword}{static} \mbox{\hyperlink{class_test_context}{TestContext}} instance(argc, argv);}
\DoxyCodeLine{93     \textcolor{keywordflow}{return} instance;}
\DoxyCodeLine{94   \}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96   \textcolor{keywordtype}{bool} isWindows() \textcolor{keyword}{const};}
\DoxyCodeLine{97   \textcolor{keywordtype}{bool} isLinux() \textcolor{keyword}{const};}
\DoxyCodeLine{98   \textcolor{keywordtype}{bool} isNvidia() \textcolor{keyword}{const};}
\DoxyCodeLine{99   \textcolor{keywordtype}{bool} isAmd() \textcolor{keyword}{const};}
\DoxyCodeLine{100   \textcolor{keywordtype}{bool} skipTest() \textcolor{keyword}{const};}
\DoxyCodeLine{101 }
\DoxyCodeLine{102   \textcolor{keyword}{const} std::string\& getCurrentTest()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} current\_test; \}}
\DoxyCodeLine{103   std::string currentPath() \textcolor{keyword}{const};}
\DoxyCodeLine{104 }
\DoxyCodeLine{105   \mbox{\hyperlink{class_test_context}{TestContext}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_test_context}{TestContext}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{106   \textcolor{keywordtype}{void} operator=(\textcolor{keyword}{const} \mbox{\hyperlink{class_test_context}{TestContext}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{107 \};}

\end{DoxyCode}
